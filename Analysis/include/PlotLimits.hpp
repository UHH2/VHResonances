#pragma once
#include <iostream>
#include <TROOT.h>
#include "TSystem.h"
#include <stdlib.h>
#include <stdio.h>
#include <iostream>
#include <fstream>
#include "TGraphAsymmErrors.h"
#include "TGraphErrors.h"
#include "TCanvas.h"
#include "TLegend.h"
#include "TFile.h"
#include "TLatex.h"
#include "UHH2/core/include/Utils.h"
#include "UHH2/VHResonances/include/constants.hpp"
#include "UHH2/VHResonances/Analysis/include/tdrstyle_all.hpp"

// const std::vector<double> MyMassPoints = {1000, 1200, 1400, 1600, 1800, 2000, 2500, 3000, 3500, 4000, 4500, 5000, 5500, 6000, 7000, 8000};
const std::vector<double> MyMassPoints = {1400, 1600, 1800, 2000, 2500, 3000, 3500, 4000, 4500, 5000};

extern const unsigned int nPoints=MyMassPoints.size();


extern const std::vector<double> theo_xsec     = {1.089e+04,3.415e+03,1.505e+03,7.783e+02,4.387e+02,2.620e+02,1.626e+02,1.038e+02,3.640e+01,1.371e+01,5.330e+00,2.133e+00,8.652e-01,3.604e-01,1.535e-01,6.639e-02,0,0};
extern const std::vector<double> theo_xsec_err = {6.314e+00,4.186e+01,9.512e-01,4.371e-01,2.517e-01,1.494e-01,9.351e-02,5.563e-02,2.002e-02,7.165e-03,2.522e-03,9.392e-04,4.011e-04,1.515e-04,6.865e-05,2.653e-05,0,0};

// extern const std::vector<double> theo_xsec     = {7.783e+02,4.387e+02,2.620e+02,1.626e+02,1.038e+02,3.640e+01,1.371e+01,5.330e+00,2.133e+00,8.652e-01,3.604e-01,1.535e-01,6.639e-02,0,0};
// extern const std::vector<double> theo_xsec_err = {4.371e-01,2.517e-01,1.494e-01,9.351e-02,5.563e-02,2.002e-02,7.165e-03,2.522e-03,9.392e-04,4.011e-04,1.515e-04,6.865e-05,2.653e-05,0,0};

extern const std::vector<double> theo_mass     = {800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000};
extern const std::vector<double> HVT_A_xsec    = {578.0999, 358.3873, 231.6927, 154.8033, 106.2204, 74.50991, 53.23298, 38.62051, 28.39542, 21.11701, 15.85439, 12.00795, 9.163542, 7.039392, 5.439621, 4.225485, 3.297668, 2.584068, 2.032477, 1.604015, 1.269687, 1.009061, 0.8013809, 0.6388036, 0.5101927, 0.4081523, 0.3269965, 0.2623107, 0.2106453, 0.1693069, 0.1361855, 0.109623, 0.08828075, 0.07113544, 0.05733185, 0.04620448, 0.03724663, 0.03002855, 0.02420639, 0.01950782, 0.01571446, 0.01265338, 0.01018433};
extern const std::vector<double> HVT_B_xsec    = {485.1621, 367.2001, 263.8817, 188.6818, 135.7415, 98.58745, 72.32583, 53.57184, 40.04648, 30.18608, 22.91748, 17.51997, 13.47566, 10.42173, 8.100062, 6.323773, 4.956944, 3.899242, 3.077397, 2.435993, 1.93346, 1.540306, 1.225945, 0.9791569, 0.7834139, 0.627741, 0.5036664, 0.4045769, 0.3252906, 0.2617513, 0.2107641, 0.1698193, 0.1368799, 0.1103879, 0.08903561, 0.07180615, 0.0579232, 0.0467275, 0.03768939, 0.03039015, 0.02449322, 0.01973149, 0.01588843};


extern const std::vector<double> ee_mass = { 800, 1000, 1500, 2000, 2500, 3000, 3500, 4000, 5000};
extern const std::vector<double> ee_xsec = {   60,   60,   25,   11,  7.5,  5.5,  4.5,    4,    4};

extern const std::vector<double> theo_xsec_inv     = {15703.333, 5512.333, 2544.333, 1340.000, 763.866, 456.833, 283.366, 179.533, 62.176, 23.075, 9.119, 3.824, 1.716, 0.803, 0.385, 0.185, 0.041, 0.007};
extern const std::vector<double> theo_xsec_err_inv = {26.24, 13.02, 4.9, 3.5, 2.2, 0.7, 0.8, 0.2, 0.036, 0.005, 0.013, 0.007, 0.004, 0.001, 0.0007, 0.0004, 5.55e-05, 1.35e-05};

// extern const std::vector<double> MassPoints_Hbb = { 800, 900, 1000, 1100, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000};
// extern const std::vector<double> expectedHbb    = { 18.675, 10.9125, 7.3125, 5.5125, 4.2937, 3.4781, 2.8594, 2.4281, 2.0719, 1.7906, 1.5609, 1.3781, 1.2328, 1.1156, 1.0125, 0.9281, 0.8578, 0.8016, 0.7547, 0.7125, 0.6797, 0.6539, 0.6328, 0.6141, 0.6000, 0.5906, 0.5813, 0.5766, 0.5813, 0.5859, 0.5953, 0.6094, 0.6234, 0.6492, 0.6797, 0.7172, 0.7594, 0.8156, 0.8203, 0.8297, 0.8438, 0.8578, 0.8766};
// extern const std::vector<double> expectedHbb0b  = { 14.325, 15.8625, 17.850, 20.325, 17.625, 14.625, 11.962, 9.7312, 7.9313, 6.3938, 5.2875, 4.4437, 3.7875, 3.2625, 2.8312, 2.4844, 2.1844, 1.9312, 1.7062, 1.5141, 1.3500, 1.2047, 1.0828, 0.9797, 0.8930, 0.8203, 0.7570, 0.7031, 0.6609, 0.6281, 0.5977, 0.5719, 0.5484, 0.5344, 0.5238, 0.5180, 0.5156, 0.5203, 0.4945, 0.4734, 0.4570, 0.4453, 0.4336};
extern const std::vector<double> MassPoints_Hbb = { 800, 900, 1000, 1200, 1300, 1400, 1500, 1600, 1700, 1800, 1900, 2000, 2100, 2200, 2300, 2400, 2500, 2600, 2700, 2800, 2900, 3000, 3100, 3200, 3300, 3400, 3500, 3600, 3700, 3800, 3900, 4000, 4100, 4200, 4300, 4400, 4500, 4600, 4700, 4800, 4900, 5000};
extern const std::vector<double> expectedHbb    = { 18.675, 10.9125, 7.3125, 4.2937, 3.4781, 2.8594, 2.4281, 2.0719, 1.7906, 1.5609, 1.3781, 1.2328, 1.1156, 1.0125, 0.9281, 0.8578, 0.8016, 0.7547, 0.7125, 0.6797, 0.6539, 0.6328, 0.6141, 0.6000, 0.5906, 0.5813, 0.5766, 0.5813, 0.5859, 0.5953, 0.6094, 0.6234, 0.6492, 0.6797, 0.7172, 0.7594, 0.8156, 0.8203, 0.8297, 0.8438, 0.8578, 0.8766};
extern const std::vector<double> expectedHbb0b  = { 14.325, 15.8625, 17.850, 17.625, 14.625, 11.962, 9.7312, 7.9313, 6.3938, 5.2875, 4.4437, 3.7875, 3.2625, 2.8312, 2.4844, 2.1844, 1.9312, 1.7062, 1.5141, 1.3500, 1.2047, 1.0828, 0.9797, 0.8930, 0.8203, 0.7570, 0.7031, 0.6609, 0.6281, 0.5977, 0.5719, 0.5484, 0.5344, 0.5238, 0.5180, 0.5156, 0.5203, 0.4945, 0.4734, 0.4570, 0.4453, 0.4336};

// extern const std::vector<double> expectedHcomb  = { 15.250, 10.8500, 8.4500, 5.0750, 4.4125, 3.6375, 3.1625, 2.6250, 2.2125, 1.8312, 1.5438, 1.2938, 1.1031, 0.9531, 0.8313, 0.7375, 0.6594, 0.5922, 0.5375, 0.4922, 0.4531, 0.4203, 0.3922, 0.3703, 0.3516, 0.3375, 0.3266, 0.3172, 0.3125, 0.3102, 0.3094, 0.3078, 0.3125, 0.3187, 0.3281, 0.3406, 0.3562, 0.3500, 0.3453, 0.3422, 0.3406, 0.3406};
// extern const std::vector<double> expectedH0lll2b= { 23.875, 13.3125, 9.0312, 5.3594, 4.3125, 3.5000, 2.9219, 2.4688, 2.1094, 1.8203, 1.6016, 1.4219, 1.2773, 1.1562, 1.0547, 0.9688, 0.9023, 0.8477, 0.8047, 0.7695, 0.7422, 0.7188, 0.6992, 0.6836, 0.6719, 0.6641, 0.6562, 0.6543, 0.6543, 0.6562, 0.6602, 0.6680, 0.6738, 0.6836, 0.6914, 0.7031, 0.7148, 0.7227, 0.7344, 0.7461, 0.7578, 0.7773};
// extern const std::vector<double> expectedH0lll0b= { 36.625, 21.8125, 22.6875, 23.00, 18.625, 14.75, 11.5625, 9.1562, 7.4062, 6.1094, 5.0781, 4.2812, 3.6562, 3.1562, 2.7422, 2.3906, 2.0938, 1.8359, 1.6172, 1.4258, 1.2656, 1.1289, 1.0156, 0.9180, 0.8359, 0.7656, 0.7070, 0.6562, 0.6133, 0.5742, 0.5391, 0.5078, 0.4785, 0.4531, 0.4297, 0.4082, 0.3887, 0.3750, 0.3613, 0.3516, 0.3438, 0.3379};
// extern const std::vector<double> expectedHcomb  = { 25.9375,13.9375,15.1875, 4.5938, 3.5312, 2.9297, 2.3906, 2.0078, 1.6797, 1.4258, 1.2109, 1.0312, 0.8945, 0.7812, 0.6914, 0.6172, 0.5527, 0.5000, 0.4551, 0.4180, 0.3857, 0.3574, 0.3350, 0.3164, 0.2998, 0.2871, 0.2754, 0.2656, 0.2578, 0.2510, 0.2441, 0.2373, 0.2314, 0.2266, 0.2217, 0.2178, 0.2129, 0.2100, 0.208, 0.20700, 0.207};

void PlotLimits(bool doObs = false, bool isHbb = false);




// HVT['B3']['Z']['XS'] = {
//     800 : 0.855309,
//     900 : 0.687575,
//     1000 : 0.509804,
//     1100 : 0.37177,
//     1200 : 0.271104,
//     1300 : 0.198844,
//     1400 : 0.146961,
//     1500 : 0.109482,
//     1600 : 0.0822156,
//     1700 : 0.0622015,
//     1800 : 0.0473673,
//     1900 : 0.036303,
//     2000 : 0.0279823,
//     2100 : 0.02168,
//     2200 : 0.0168765,
//     2300 : 0.0131933,
//     2400 : 0.0103538,
//     2500 : 0.00815289,
//     2600 : 0.00644032,
//     2700 : 0.0051021,
//     2800 : 0.00405245,
//     2900 : 0.00323048,
//     3000 : 0.00257265,
//     3100 : 0.00205583,
//     3200 : 0.00164562,
//     3300 : 0.00131918,
//     3400 : 0.00105885,
//     3500 : 0.000850838,
//     3600 : 0.000684318,
//     3700 : 0.000550813,
//     3800 : 0.000443641,
//     3900 : 0.000357546,
//     4000 : 0.000288261,
//     4100 : 0.000232521,
//     4200 : 0.000187582,
//     4300 : 0.000151311,
//     4400 : 0.000122078,
//     4500 : 0.0000984981,
//     4600 : 0.0000794585,
//     4700 : 0.0000640791,
//     4800 : 0.000051652,
//     4900 : 0.0000416155,
//     5000 : 0.0000335141,
//     5100 : 0.0000269688,
//     5200 : 0.0000216883,
//     5300 : 0.0000174251,
//     5400 : 0.0000139886,
//     5500 : 0.0000112173,
//     5600 : 0.0000089865,
//     5700 : 0.0000071896,
//     5800 : 0.0000057453,
//     5900 : 0.0000045843,
//     6000 : 0.0000036528,
//
//
// }
//
// HVT['B3']['Z']['BR'] = {
//     800 : 0.567236,
//     900 : 0.534051,
//     1000 : 0.517614,
//     1100 : 0.507523,
//     1200 : 0.500699,
//     1300 : 0.495803,
//     1400 : 0.492143,
//     1500 : 0.489321,
//     1600 : 0.487091,
//     1700 : 0.485295,
//     1800 : 0.483825,
//     1900 : 0.482604,
//     2000 : 0.481578,
//     2100 : 0.480707,
//     2200 : 0.479961,
//     2300 : 0.479317,
//     2400 : 0.478756,
//     2500 : 0.478265,
//     2600 : 0.477833,
//     2700 : 0.477449,
//     2800 : 0.477109,
//     2900 : 0.476804,
//     3000 : 0.47653,
//     3100 : 0.476283,
//     3200 : 0.47606,
//     3300 : 0.475857,
//     3400 : 0.475673,
//     3500 : 0.475504,
//     3600 : 0.47535,
//     3700 : 0.475209,
//     3800 : 0.475078,
//     3900 : 0.474958,
//     4000 : 0.474847,
//     4100 : 0.474744,
//     4200 : 0.474649,
//     4300 : 0.47456,
//     4400 : 0.474477,
//     4500 : 0.4744,
//     4600 : 0.474328,
//     4700 : 0.47426,
//     4800 : 0.474197,
//     4900 : 0.474138,
//     5000 : 0.474082,
//     5100 : 0.474847,
//     5200 : 0.474847,
//     5300 : 0.474847,
//     5400 : 0.474847,
//     5500 : 0.474847,
//     5600 : 0.474847,
//     5700 : 0.474847,
//     5800 : 0.474847,
//     5900 : 0.474847,
//     6000 : 0.474847,
// }
//
//
// HVT['A1']['Z']['XS'] = {
//     500 : 170.378,
//     600 : 85.0684,
//     700 : 46.9232,
//     800 : 27.7679,
//     900 : 17.3149,
//     1000 : 11.2428,
//     1100 : 7.53682,
//     1200 : 5.18495,
//     1300 : 3.64455,
//     1400 : 2.60813,
//     1500 : 1.89476,
//     1600 : 1.39466,
//     1700 : 1.03814,
//     1800 : 0.780036,
//     1900 : 0.591187,
//     2000 : 0.451406,
//     2100 : 0.346939,
//     2200 : 0.26821,
//     2300 : 0.208423,
//     2400 : 0.162712,
//     2500 : 0.127539,
//     2600 : 0.100341,
//     2700 : 0.0792067,
//     2800 : 0.0627105,
//     2900 : 0.0498474,
//     3000 : 0.0395947,
//     3100 : 0.0315669,
//     3200 : 0.025215,
//     3300 : 0.0201745,
//     3400 : 0.0161649,
//     3500 : 0.0129686,
//     3600 : 0.0104153,
//     3700 : 0.00837208,
//     3800 : 0.00673479,
//     3900 : 0.00542162,
//     4000 : 0.0043664,
//     4100 : 0.00351863,
//     4200 : 0.00283602,
//     4300 : 0.00228571,
//     4400 : 0.00184267,
//     4500 : 0.00148565,
//     4600 : 0.00119766,
//     4700 : 0.000965227,
//     4800 : 0.00077757,
//     4900 : 0.000626126,
//     5000 : 0.00050397,
// }
//
// HVT['A1']['Z']['BR'] = {
//     500 : 0.0215299,
//     600 : 0.0212147,
//     700 : 0.0209845,
//     800 : 0.020819,
//     900 : 0.0206982,
//     1000 : 0.0206081,
//     1100 : 0.0205396,
//     1200 : 0.0204863,
//     1300 : 0.0204442,
//     1400 : 0.0204104,
//     1500 : 0.0203828,
//     1600 : 0.0203601,
//     1700 : 0.0203412,
//     1800 : 0.0203252,
//     1900 : 0.0203116,
//     2000 : 0.0203,
//     2100 : 0.02029,
//     2200 : 0.0202812,
//     2300 : 0.0202736,
//     2400 : 0.0202669,
//     2500 : 0.020261,
//     2600 : 0.0202557,
//     2700 : 0.020251,
//     2800 : 0.0202468,
//     2900 : 0.020243,
//     3000 : 0.0202396,
//     3100 : 0.0202365,
//     3200 : 0.0202337,
//     3300 : 0.0202311,
//     3400 : 0.0202288,
//     3500 : 0.0202266,
//     3600 : 0.0202246,
//     3700 : 0.0202228,
//     3800 : 0.0202212,
//     3900 : 0.0202196,
//     4000 : 0.0202182,
//     4100 : 0.0202168,
//     4200 : 0.0202156,
//     4300 : 0.0202145,
//     4400 : 0.0202134,
//     4500 : 0.0202124,
//     4600 : 0.0202114,
//     4700 : 0.0202106,
//     4800 : 0.0202097,
//     4900 : 0.020209,
//     5000 : 0.0202082,
// }
